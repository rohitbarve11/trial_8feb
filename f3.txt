this is by Rohit.
New features added.
Bugs fixed.
